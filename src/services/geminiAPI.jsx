import { GoogleGenerativeAI } from "@google/generative-ai";


const apiKey = import.meta.env.VITE_GOOGLE_GEMINI_AI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-2.5-flash-preview-05-20",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 40,
  maxOutputTokens: 8192,
  responseMimeType: "text/plain",
};

  export const chatSession = model.startChat({
    generationConfig,
    history: [
      {
        role: "user",
        parts: [
          {text: "Generate a detailed learning guide for the exam: {examName}.\n          Syllabus: {syllabus}.\n          Difficulty Level: {difficultyLevel}.\n          \n          Provide the following:\n          1. Key Concepts: A detailed explanation of the core concepts.\n          2. Study Strategies: A list of effective study strategies.\n          3. Importance in Exams: Explain why this topic is important for the exam.\n          \n          // Return only JSON. No additional text outside JSON format.\n"},
        ],
      },
      {
        role: "model",
        parts: [
          {text: "```json\n{\n  \"examName\": \"{examName}\",\n  \"syllabus\": \"{syllabus}\",\n  \"difficultyLevel\": \"{difficultyLevel}\",\n  \"learningGuide\": {\n    \"keyConcepts\": [\n      {\n        \"conceptName\": \"Concept 1 Name\",\n        \"description\": \"Detailed explanation of Concept 1. This should include the definition, key principles, related formulas (if applicable), and common pitfalls. Example: If the concept is 'Object-Oriented Programming', the description could include: Definition - A programming paradigm based on the concept of 'objects', which contain data, in the form of fields (often known as attributes or properties), and code, in the form of procedures (often known as methods). Key Principles - Encapsulation, Inheritance, Polymorphism, Abstraction.  Pitfalls - Overuse of inheritance, lack of clear responsibility assignment, tight coupling.\",\n        \"example\": \"Provide a practical example demonstrating the application of the concept. This could be a code snippet, a diagram, or a real-world scenario.\",\n        \"relatedTerms\": [\"Term 1 related to Concept 1\", \"Term 2 related to Concept 1\"]\n      },\n      {\n        \"conceptName\": \"Concept 2 Name\",\n        \"description\": \"Detailed explanation of Concept 2. Similar to Concept 1, include definition, key principles, formulas, and pitfalls.\",\n        \"example\": \"Provide a practical example demonstrating the application of the concept.\",\n        \"relatedTerms\": [\"Term 1 related to Concept 2\", \"Term 2 related to Concept 2\"]\n      },\n      {\n        \"conceptName\": \"Concept 3 Name\",\n        \"description\": \"Detailed explanation of Concept 3. Similar to Concept 1, include definition, key principles, formulas, and pitfalls.\",\n        \"example\": \"Provide a practical example demonstrating the application of the concept.\",\n        \"relatedTerms\": [\"Term 1 related to Concept 3\", \"Term 2 related to Concept 3\"]\n      },\n      {\n        \"conceptName\": \"Concept N Name\",\n        \"description\": \"Detailed explanation of Concept N. Similar to Concept 1, include definition, key principles, formulas, and pitfalls.\",\n        \"example\": \"Provide a practical example demonstrating the application of the concept.\",\n        \"relatedTerms\": [\"Term 1 related to Concept N\", \"Term 2 related to Concept N\"]\n      }\n    ],\n    \"studyStrategies\": [\n      {\n        \"strategyName\": \"Active Recall\",\n        \"description\": \"Explain how to use active recall. Example: Instead of passively rereading notes, actively try to retrieve information from memory. Use flashcards, self-testing, or practice questions to test your understanding.\",\n        \"benefits\": [\"Improved retention\", \"Identification of knowledge gaps\"]\n      },\n      {\n        \"strategyName\": \"Spaced Repetition\",\n        \"description\": \"Explain how to implement spaced repetition. Example: Review material at increasing intervals of time. This helps reinforce learning and prevents forgetting. Use spaced repetition software like Anki or create your own system.\",\n        \"benefits\": [\"Long-term retention\", \"Efficient use of study time\"]\n      },\n      {\n        \"strategyName\": \"Practice Questions and Mock Exams\",\n        \"description\": \"Emphasize the importance of practice questions. Example: Regularly solve practice questions and take mock exams that simulate the actual exam environment. This helps familiarize yourself with the exam format, question types, and time constraints.\",\n        \"benefits\": [\"Familiarity with exam format\", \"Time management skills\", \"Identification of weak areas\"]\n      },\n      {\n        \"strategyName\": \"Concept Mapping\",\n        \"description\": \"Describe how to create and use concept maps. Example: Create visual representations of concepts and their relationships. This helps to organize your thoughts and understand the connections between different topics.\",\n        \"benefits\": [\"Improved understanding of relationships\", \"Better organization of knowledge\"]\n      },\n      {\n        \"strategyName\": \"Teach Someone Else\",\n        \"description\": \"Explain the benefits of teaching. Example: Trying to explain a concept to someone else forces you to understand it thoroughly. It also helps you identify any gaps in your knowledge.\",\n        \"benefits\": [\"Deepened understanding\", \"Improved communication skills\"]\n      },\n       {\n        \"strategyName\": \"Focus on Weak Areas\",\n        \"description\": \"Prioritize studying the topics you find most challenging. Don't neglect areas you already understand, but dedicate extra time to improving your weaknesses.\",\n        \"benefits\": [\"Improved overall score\", \"Increased confidence\"]\n      }\n    ],\n    \"importanceInExams\": [\n      {\n        \"topic\": \"Concept 1 Name (as above)\",\n        \"explanation\": \"Explain why Concept 1 is crucial for the exam. Example: This concept is fundamental to understanding [related topic] and frequently appears in questions that assess your ability to [specific skill, e.g., apply object-oriented principles to design software]. Expect to see questions on [specific question types, e.g., identifying inheritance relationships, implementing polymorphism].\",\n        \"weightage\": \"Estimated percentage or weightage of questions related to this topic in the exam (e.g., 15-20%)\"\n      },\n      {\n        \"topic\": \"Concept 2 Name (as above)\",\n        \"explanation\": \"Explain why Concept 2 is crucial for the exam. Example: A strong understanding of this concept is essential for answering questions related to [related topic]. Expect questions that require you to [specific skill, e.g., analyze algorithm complexity, debug code].\",\n        \"weightage\": \"Estimated percentage or weightage of questions related to this topic in the exam (e.g., 10-15%)\"\n      },\n      {\n        \"topic\": \"Concept 3 Name (as above)\",\n        \"explanation\": \"Explain why Concept 3 is crucial for the exam. Example: This concept forms the basis for [related topic] and is often tested through [specific question types, e.g., multiple-choice questions focusing on definitions, problem-solving scenarios].\",\n        \"weightage\": \"Estimated percentage or weightage of questions related to this topic in the exam (e.g., 20-25%)\"\n      },\n      {\n        \"topic\": \"Concept N Name (as above)\",\n        \"explanation\": \"Explain why Concept N is crucial for the exam. Example: This concept is frequently integrated with other topics and appears in more complex, application-based questions. Expect to see questions that require you to [specific skill, e.g., design database schemas, optimize query performance].\",\n        \"weightage\": \"Estimated percentage or weightage of questions related to this topic in the exam (e.g., 5-10%)\"\n      }\n    ]\n  }\n}\n```"},
        ],
      },
    ],
  });

  